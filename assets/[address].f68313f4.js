import{_ as S}from"./ToggleButton.2a4219f7.js";import{_ as j}from"./WalletAddress.5041787c.js";import{_ as v,i as T,a as D}from"./index.0908e9b4.js";import{o,c as l,d as q,r as C,D as A,a as n,t as B,h as p,f as E,i as g,k as u,m,G as y,H as w}from"./vendor.309dbb5d.js";import{d as V,_ as z,a as K}from"./debounce.dc046047.js";const L={props:{data:{type:String}},data(){return{isDarkMode:T}},methods:{render(){const s={errorCorrectionLevel:"H",color:{dark:"000000",light:"ffffff"}};this.isDarkMode&&(s.color={dark:"ffffff",light:"18181b"}),qrcode.toDataURL(this.data,s).then(t=>{this.$refs.img.src=t})},resize(){const s=this.$refs.img.classList;s.contains("w-20")?s.remove("w-20"):s.add("w-20")}},mounted(){this.render(),this.$refs.img.classList.add("w-20")},watch:{isDarkMode:{handler(){this.render()}}}};function N(s,t,c,d,e,r){return o(),l("img",{ref:"img",style:{"image-rendering":"pixelated"},src:"",alt:"",class:"cursor-pointer max-w-80",title:"Click to zoom",onClick:t[0]||(t[0]=(...i)=>r.resize&&r.resize(...i))},null,512)}var R=v(L,[["render",N]]);const U={class:"mx-auto text-gray-200 p-4 lg:text-lg sm:text-sm text-xs rounded-md shadow flex items-center"},H={style:{"white-space":"nowrap"},class:"block overflow-hidden w-60 sm:w-auto mr-2"},M=q({props:{private:null},setup(s){const t=s,c=C(),d=C(!1),e=V(f=>{f(),d.value=!1},1e3),{show:r,hide:i}=A(c,{content:"Copied",trigger:"manual",hideOnClick:!1}),_=async()=>{try{await navigator.clipboard.writeText(t.private),r()}catch{}d.value=!0,e(i)};return(f,b)=>{const h=z,x=K;return o(),l("code",U,[n("span",H,B(t.private),1),n("button",{ref:(a,k)=>{k.copyButton=a,c.value=a},class:"focus:outline-none","aria-label":"Copy install command"},[n("button",{ref:(a,k)=>{k.copyButton=a,c.value=a},class:"focus:outline-none","aria-label":"Copy install command"},[d.value?(o(),p(x,{key:1,class:"inline-block fill-current text-green-500 cursor-pointer mb-1","aria-hidden":"true",onClick:_})):(o(),p(h,{key:0,class:"inline-block fill-current text-gray-200 cursor-pointer hover:text-white mb-1","aria-hidden":"true",onClick:_}))],512)],512)])}}}),O={data(){return{faces:["(\u273F\u25E0\u203F\u25E0)","\u2267\u25E1\u2266","(\uFF89\u25D5\u30EE\u25D5)\uFF89*:\uFF65\uFF9F\u2727","(\u3065\uFF61\u25D5\u203F\u203F\u25D5\uFF61)\u3065","(\u25B0\u02D8\u25E1\u02D8\u25B0)","\u25CE[\u25AA\u203F\u25AA]\u25CE","(\u273F \u2665\u203F\u2665)","\u2665\u203F\u2665","(\uFFE3\u3002\uFFE3)\uFF5E\uFF5A\uFF5A\uFF5A","( \xB4_\u2283\uFF40)","( \u0361\xB0 \u035C\u0296 \u0361\xB0)","(\u3000\uFF9F,_\u309D\uFF9F)"],address:this.$route.params.address,wallets:[],node_input:"",nodes:[],show_key:!1,wallet:null,show_qr_code:!1,transaction:{to:this.$route.query.to||"",amount:this.$route.query.amount||"",miner_fee:""},transaction_str:"",transaction_json:"",show:"",explorer:!0}},methods:{toggle_explorer(s){typeof s=="boolean"&&(this.explorer=s)},sign_transaction(){this.transaction_json=null;try{if(!this.transaction.to)throw new Error("Recipient address is empty");if(!Address.verifyChecksumAddress(base58.decode(this.transaction.to)))throw new Error("Recipient address invalid checksum");const t=Address.toBuffer(this.transaction.to);if(this.transaction.to===this.address)throw new Error("Recipient address is the same as sender address");if(!this.transaction.amount)throw new Error("Amount is empty");const c=beautifyBigInt(parseBigInt(this.transaction.amount));if(!this.transaction.miner_fee)throw new Error("Miner fee is empty");const d=beautifyBigInt(parseBigInt(this.transaction.miner_fee)),e=this.wallet.key,r=new Transaction({to:t,amount:c,minerFee:d,timestamp:Date.now()});r.sign(base58.decode(e));const i=r.isValid();if(i)throw new Error(`Transaction invalid 0b${i.toString(2)}`);this.transaction_str="TX_"+Buffer.from(JSON.stringify(Transaction.minify(r))).toString("hex"),this.transaction_json=this.transaction_str}catch(s){this.transaction_str=s}},del(){this.wallets=this.wallets.filter(s=>s.address!==this.address),this.wallet=null,this.$router.push("/wallet")},async share(){const s=this.qr_address,t={errorCorrectionLevel:"H",color:{dark:"000000",light:"ffffff"}},c=e=>{let r=atob(e.split(",")[1]),i=new ArrayBuffer(r.length),_=new Uint8Array(i);for(var f=0;f<r.length;f++)_[f]=r.charCodeAt(f);return new Blob([i],{type:"image/png"})},d=async()=>new File([c(await qrcode.toDataURL(s,t))],"qrcode.png",{type:"image/png"});window.navigator.share({title:"Send Viscoin",url:s,files:[await d()]})}},mounted(){document.title="Viscoin.net - Wallet - "+this.$route.params.address,localStorage.keys&&(this.wallets=JSON.parse(localStorage.keys).map(s=>{const t=base58.decode(s),c=addressFromPublicKey(publicKeyFromPrivateKey(t)),d=Address.convertToChecksumAddress(c),e=base58.encode(d);return{key:s,address:e}}),this.wallet=this.wallets.find(s=>s.address===this.address)),localStorage.nodes&&(this.nodes=JSON.parse(localStorage.nodes)),this.qr_address=`${location.origin}/#/wallet?to=${this.wallet?.address}`,this.qr_key=`${location.origin}/#/wallet/import?key=${this.wallet?.key}`},watch:{wallets:{handler(s){localStorage.keys=JSON.stringify(s.map(t=>t=t.key))},deep:!0},nodes:{handler(s){localStorage.nodes=JSON.stringify(s)},deep:!0}}},I={class:"flex flex-col justify-between h-full mx-6"},J={class:"flex flex-col w-full"},F={class:"prose prose-discord dark:prose-light lg:prose-lg mx-auto pb-8 w-full mt-8"},W={class:"flex justify-between"},P=n("span",null,"Back",-1),Q=n("span",null,"Back",-1),G={key:1,style:{"user-select":"none"},class:"flex justify-center mt-10 mb-20"},X={key:0,class:"prose prose-discord dark:prose-light lg:prose-lg mx-auto w-full"},Y={key:0,class:"max-w-3xl sm:mx-auto sm:px-16 flex flex-col md:px-12"},Z={class:"flex flex-col sm:flex-row justify-between mb-10"},$=n("strong",null,"Sending\xA0from",-1),ee={class:"underline"},te=n("label",{style:{"font-size":".8rem"},for:"address"},"The base58 address of the recipient.",-1),se=n("label",{style:{"font-size":".8rem"},for:"amount"},"How much the recipient will receive.",-1),oe=n("label",{style:{"font-size":".8rem"},for:"miner-fee"},"How much the miner will receive.",-1),re=["href"],ne={key:1,class:"max-w-3xl sm:mx-auto text-center sm:px-16 flex flex-col gap-10 md:px-12"},ae={class:"flex flex-row justify-center"},ie={key:2,style:{"user-select":"none"},class:"flex flex-row justify-center gap-10 w-full"},le=["href"],ce={key:3,style:{"user-select":"none"},class:"flex flex-row justify-center w-full my-5 pb-10"},de={key:1};function he(s,t,c,d,e,r){const i=E("router-link"),_=S,f=j,b=R,h=D,x=M;return o(),l("div",I,[n("div",J,[n("div",F,[n("h4",W,[e.show===""?(o(),p(i,{key:0,to:"/wallet"},{default:g(()=>[P]),_:1})):(o(),p(i,{key:1,to:"/wallet/"+this.address,onClick:t[0]||(t[0]=a=>this.show="")},{default:g(()=>[Q]),_:1},8,["to"])),u(_,{defaultState:e.explorer,labelEnableText:"Vis.gg",labelDisableText:"Legacy",onChange:r.toggle_explorer},null,8,["defaultState","onChange"])])]),e.show===""?(o(),p(f,{key:0,title:"address (public)",class:"max-w-screen-sm filter drop-shadow-lg mx-auto",address:e.wallet?.address},null,8,["address"])):m("",!0),e.show===""&&s.qr_address?(o(),l("div",G,[u(b,{data:s.qr_address},null,8,["data"])])):m("",!0)]),e.wallet?(o(),l("div",X,[e.show==="transaction"?(o(),l("div",Y,[n("div",Z,[$,n("span",ee,B(this.address),1)]),te,y(n("input",{name:"address",class:"bg-gray-200 text-gray-800 hover:bg-gray-300 hover:text-black dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-900 dark:hover:text-white mb-10","onUpdate:modelValue":t[1]||(t[1]=a=>e.transaction.to=a),type:"text",placeholder:"Enter address..."},null,512),[[w,e.transaction.to]]),se,y(n("input",{name:"amount",class:"bg-gray-200 text-gray-800 hover:bg-gray-300 hover:text-black dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-900 dark:hover:text-white mb-10","onUpdate:modelValue":t[2]||(t[2]=a=>e.transaction.amount=a),type:"text",placeholder:"Enter amount..."},null,512),[[w,e.transaction.amount]]),oe,y(n("input",{name:"miner-fee",class:"bg-gray-200 text-gray-800 hover:bg-gray-300 hover:text-black dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-900 dark:hover:text-white mb-6","onUpdate:modelValue":t[3]||(t[3]=a=>e.transaction.miner_fee=a),type:"text",placeholder:"Enter miner fee..."},null,512),[[w,e.transaction.miner_fee]]),u(h,{style:{"user-select":"none"},class:"mx-auto mb-10",onClick:r.sign_transaction,text:"Sign Transaction"},null,8,["onClick"]),e.transaction_str?y((o(),l("textarea",{key:0,class:"custom-scroll bg-gray-200 text-gray-800 hover:bg-gray-300 hover:text-black dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-900 dark:hover:text-white resize-none text-xs mb-6","onUpdate:modelValue":t[4]||(t[4]=a=>e.transaction_str=a),name:"",id:"",cols:"30",rows:"6"},null,512)),[[w,e.transaction_str]]):m("",!0),e.explorer&&e.transaction_json?(o(),l("a",{key:1,href:"https://vis.gg/#/search/"+e.transaction_json,class:"pb-10"},[u(h,{style:{"user-select":"none"},class:"mx-auto",onClick:r.sign_transaction,text:"Sign & Broadcast"},null,8,["onClick"])],8,re)):e.transaction_json?(o(),p(i,{key:2,to:"/api?search="+e.transaction_json,class:"pb-10"},{default:g(()=>[u(h,{style:{"user-select":"none"},class:"mx-auto",onClick:r.sign_transaction,text:"Sign & Broadcast"},null,8,["onClick"])]),_:1},8,["to"])):m("",!0)])):m("",!0),e.show==="private_key"?(o(),l("div",ne,[n("div",ae,[u(h,{class:"mx-auto hover:bg-red-600 bg-red-500 dark:bg-red-500 dark:hover:bg-red-600",onClick:r.del,text:"Delete"},null,8,["onClick"]),u(h,{class:"mx-auto",onClick:t[5]||(t[5]=a=>e.show_key=!e.show_key),text:e.show_key?"Hide Key":"Show Key"},null,8,["text"])]),e.show_key?(o(),p(x,{key:0,title:"address (public)",class:"max-w-screen-sm w-60",private:e.wallet?.key},null,8,["private"])):m("",!0)])):m("",!0),e.show===""?(o(),l("div",ie,[u(h,{text:"Create Transaction",onClick:t[6]||(t[6]=a=>e.show=e.show==="transaction"?e.show="":"transaction")}),e.explorer?(o(),l("a",{key:0,href:"https://vis.gg/#/explorer/"+e.wallet.address},[u(h,{class:"mx-auto",text:"Check Balance"})],8,le)):(o(),p(i,{key:1,to:"/api?search=balance/"+e.wallet.address},{default:g(()=>[u(h,{class:"mx-auto",text:"Check Balance"})]),_:1},8,["to"]))])):m("",!0),e.show===""?(o(),l("div",ce,[u(h,{text:"Private Key",onClick:t[7]||(t[7]=a=>e.show=e.show==="private_key"?e.show="":"private_key")})])):m("",!0)])):m("",!0),e.show!==""?(o(),l("div",de)):m("",!0)])}var ge=v(O,[["render",he]]);export{ge as default};
